# wjxDDL (问卷星速写)

这是一个用 Python + Selenium + Tkinter 编写的桌面工具，用于自动填写问卷星问卷并批量提交。项目提供了图形界面用于配置题目分布、权重、填空答案等，并可以启动多个浏览器实例并发提交。

**注意**：此项目仅供学习与测试目的使用，请确保对目标问卷有自动提交的授权，避免滥用或违反他人服务条款。

---

**主要特性**

- 可从问卷链接解析题目并进入配置向导
- 支持题型：单选、复选、下拉、矩阵、量表、填空、滑块、排序等
- 支持分布方式：完全随机、均等概率、自定义权重（滑块/输入）
- 批量并发提交（可配置浏览器数量）
- UI 改进：统一 ttk 复选框样式，增加“全选”复选框，控制题目列表高度避免按钮被挤出
- 性能优化：减少提交后的等待时间以加快浏览器关闭速度

---

**运行环境**

- Windows / Linux 均可运行（需安装 Chrome）
- Python 3.8+
- 推荐创建虚拟环境（venv / conda）

**Python 依赖**（可用 `requirements.txt`）

- selenium
- Pillow
- requests

例如，使用 pip 安装依赖：

```pwsh
python -m pip install -r requirements.txt
```

如果没有 `requirements.txt`，可以单独安装：

```pwsh
python -m pip install selenium pillow requests
```

---

**如何运行**

1. 确保 Chrome 已安装，并且 ChromeDriver 与 Chrome 版本兼容。将 `chromedriver` 放在 PATH 中或与脚本同一目录。
2. 在项目根目录运行：

```pwsh
python fuck-wjx.py
```

3. 在打开的 GUI 中：
   - 填写问卷链接，点击“预览问卷”解析题目。
   - 使用配置向导或手动添加题目配置。
   - 设置目标份数与浏览器数量，点击“开始执行”。

---

**关键配置说明**

- `问卷链接`：填写问卷星页面（示例：`https://v.wjx.cn/vm/...`）。
- `目标份数`：要提交的总份数。
- `浏览器数量`：并发浏览器实例数量（越大越快，但更占资源）。
- `分布方式`：
  - `完全随机`：随机选择答案；
  - `均等概率`：按均等概率选择；
  - `自定义权重`：手动输入或使用滑块设置权重；
- `全选`：题目列表左上角的复选框用于一次勾选/取消勾选所有题目，支持批量删除与编辑。

---

**已知调整 / 注意事项**

- 为避免底部控制按钮被题目区域挤出，题目配置区和题目列表使用了高度限制并启用了滚动。
- 题目列表的复选框已统一为 `ttk.Checkbutton`，显示更美观。
- 提交速度已优化：提交后等待时间从原先较长的固定延时缩短，从而更快退出浏览器（注意：减少等待可能在某些问卷有反扒验证时需要调整）。
- 如果出现 Chrome 或 ChromeDriver 版本不兼容，请更新 ChromeDriver。

---

**安全与合规**

请仅在得到授权或用于测试目的时运行此工具。自动提交问卷可能违反服务条款或法律法规，请自行承担风险。

---

**如何贡献**

欢迎提交 issue 或 PR：
- 修复解析稳定性
- 增加对更多题型/页面结构的兼容
- 改进并发与错误处理

---

文件位置：
- 主脚本：`d:\wjxDDL-master\fuck-wjx.py`

如果你希望我把 README 翻译成英文或补充更多运行示例（如 headless 调试、chromedriver 下载链接等），告诉我，我可以继续完善。